<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane prefHeight="900.0" prefWidth="1400.0" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="br.edu.ifba.saj.orquestrador.controller.OrquestradorController">
    <top>
        <VBox alignment="CENTER_LEFT" spacing="10.0" style="-fx-background-color: #1a252f; -fx-padding: 20;">
            <children>
                <Label text="Dashboard do Orquestrador" textFill="white">
                    <font><Font name="Segoe UI Bold" size="28.0" /></font>
                </Label>

                <!-- Status Cards -->
                <HBox spacing="20.0" alignment="CENTER_LEFT">
                    <children>
                        <VBox alignment="CENTER" spacing="5.0" style="-fx-background-color: #2c3e50; -fx-padding: 15; -fx-background-radius: 10;">
                            <children>
                                <Label text="Status do Servidor" textFill="#bdc3c7">
                                    <font><Font size="12.0" /></font>
                                </Label>
                                <Label fx:id="statusServidorLabel" text="INATIVO" textFill="#e74c3c">
                                    <font><Font name="Segoe UI Bold" size="16.0" /></font>
                                </Label>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5.0" style="-fx-background-color: #2c3e50; -fx-padding: 15; -fx-background-radius: 10;">
                            <children>
                                <Label text="Workers Ativos" textFill="#bdc3c7">
                                    <font><Font size="12.0" /></font>
                                </Label>
                                <Label fx:id="totalWorkersLabel" text="0" textFill="#3498db">
                                    <font><Font name="Segoe UI Bold" size="16.0" /></font>
                                </Label>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5.0" style="-fx-background-color: #2c3e50; -fx-padding: 15; -fx-background-radius: 10;">
                            <children>
                                <Label text="Total de Tarefas" textFill="#bdc3c7">
                                    <font><Font size="12.0" /></font>
                                </Label>
                                <Label fx:id="totalTarefasLabel" text="0" textFill="#f39c12">
                                    <font><Font name="Segoe UI Bold" size="16.0" /></font>
                                </Label>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5.0" style="-fx-background-color: #2c3e50; -fx-padding: 15; -fx-background-radius: 10;">
                            <children>
                                <Label text="Usuários Conectados" textFill="#bdc3c7">
                                    <font><Font size="12.0" /></font>
                                </Label>
                                <Label fx:id="totalUsuariosLabel" text="0" textFill="#27ae60">
                                    <font><Font name="Segoe UI Bold" size="16.0" /></font>
                                </Label>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5.0" style="-fx-background-color: #2c3e50; -fx-padding: 15; -fx-background-radius: 10;">
                            <children>
                                <Label text="Lamport Clock" textFill="#bdc3c7">
                                    <font><Font size="12.0" /></font>
                                </Label>
                                <Label fx:id="lamportClockLabel" text="0" textFill="#9b59b6">
                                    <font><Font name="Segoe UI Bold" size="16.0" /></font>
                                </Label>
                            </children>
                        </VBox>
                    </children>
                </HBox>

                <!-- Control Buttons -->
                <HBox spacing="10.0" alignment="CENTER_LEFT">
                    <children>
                        <Button fx:id="iniciarServidorBtn" text="Iniciar Servidor" onAction="#iniciarServidor"
                                style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 16;" />
                        <Button fx:id="pararServidorBtn" text="Parar Servidor" onAction="#pararServidor"
                                style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 16;" />
                        <Button text="Atualizar Dados" onAction="#atualizarDados"
                                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 16;" />
                        <Button fx:id="limparLogBtn" text="Limpar Log" onAction="#limparLog"
                                style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 16;" />
                    </children>
                </HBox>
            </children>
        </VBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.7" style="-fx-background-color: #ecf0f1;">
            <items>
                <!-- Left Panel - Tables -->
                <VBox spacing="15.0">
                    <padding><Insets top="15" right="10" bottom="15" left="15" /></padding>
                    <children>
                        <!-- Workers Table -->
                        <VBox spacing="5.0">
                            <children>
                                <Label text="Workers Ativos" styleClass="section-title">
                                    <font><Font name="Segoe UI Bold" size="18.0" /></font>
                                </Label>
                                <TableView fx:id="tabelaWorkers" prefHeight="200.0" VBox.vgrow="SOMETIMES">
                                    <columns>
                                        <TableColumn fx:id="workerIdCol" prefWidth="200.0" text="ID do Worker" />
                                        <TableColumn fx:id="workerStatusCol" prefWidth="100.0" text="Status" />
                                        <TableColumn fx:id="workerTarefasCol" prefWidth="100.0" text="Tarefas" />
                                        <TableColumn fx:id="workerUltimoHeartbeatCol" prefWidth="120.0" text="Último Heartbeat" />
                                    </columns>
                                </TableView>
                            </children>
                        </VBox>

                        <!-- Tasks Table -->
                        <VBox spacing="5.0">
                            <children>
                                <Label text="Tarefas do Sistema" styleClass="section-title">
                                    <font><Font name="Segoe UI Bold" size="18.0" /></font>
                                </Label>
                                <TableView fx:id="tabelaTarefas" prefHeight="250.0" VBox.vgrow="ALWAYS">
                                    <columns>
                                        <TableColumn fx:id="tarefaIdCol" prefWidth="150.0" text="ID da Tarefa" />
                                        <TableColumn fx:id="tarefaDescCol" prefWidth="200.0" text="Descrição" />
                                        <TableColumn fx:id="tarefaStatusCol" prefWidth="100.0" text="Status" />
                                        <TableColumn fx:id="tarefaWorkerCol" prefWidth="150.0" text="Worker" />
                                        <TableColumn fx:id="tarefaUsuarioCol" prefWidth="100.0" text="Usuário" />
                                    </columns>
                                </TableView>
                            </children>
                        </VBox>

                        <!-- Users Table -->
                        <VBox spacing="5.0">
                            <children>
                                <Label text="Usuários Conectados" styleClass="section-title">
                                    <font><Font name="Segoe UI Bold" size="18.0" /></font>
                                </Label>
                                <TableView fx:id="tabelaUsuarios" prefHeight="150.0" VBox.vgrow="SOMETIMES">
                                    <columns>
                                        <TableColumn fx:id="usuarioNomeCol" prefWidth="200.0" text="Nome do Usuário" />
                                        <TableColumn fx:id="usuarioStatusCol" prefWidth="120.0" text="Status" />
                                        <TableColumn fx:id="usuarioTarefasCol" prefWidth="100.0" text="Total Tarefas" />
                                    </columns>
                                </TableView>
                            </children>
                        </VBox>
                    </children>
                </VBox>

                <!-- Right Panel - Chart and Log -->
                <VBox spacing="15.0">
                    <padding><Insets top="15" right="15" bottom="15" left="10" /></padding>
                    <children>
                        <!-- Chart Section -->
                        <VBox spacing="5.0">
                            <children>
                                <Label text="Distribuição de Tarefas" styleClass="section-title">
                                    <font><Font name="Segoe UI Bold" size="18.0" /></font>
                                </Label>
                                <PieChart fx:id="graficoStatusTarefas" prefHeight="300.0" />
                            </children>
                        </VBox>

                        <!-- Log Section -->
                        <VBox spacing="5.0" VBox.vgrow="ALWAYS">
                            <children>
                                <Label text="Log do Sistema" styleClass="section-title">
                                    <font><Font name="Segoe UI Bold" size="18.0" /></font>
                                </Label>
                                <TextArea fx:id="logArea" prefHeight="250.0" VBox.vgrow="ALWAYS"
                                          style="-fx-font-family: 'Consolas', 'Monaco', monospace; -fx-font-size: 12px;" />
                            </children>
                        </VBox>
                    </children>
                </VBox>
            </items>
        </SplitPane>
    </center>
</BorderPane>